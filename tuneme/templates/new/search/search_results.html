{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags comments i18n%}

{% block content %}
{% if search_results %}
<h2 class="heading heading--search">{% trans "your results: "%}{{search_query}}</h2>
  <ul class="article-list">
  {% for page in search_results %}
    {% with parent_section=page.get_parent_section ancestor=page.get_parent_section.get_ancestors.last %}
    {% if ancestor.sectionpage.image %}
      <li class="article-list__item">
      <div class="">
        <h4 class="section-heading section-heading{{page.get_parent_section.get_effective_extra_style_hints}}">
         <a href="{% pageurl page %}">{{ parent_section.title }}</a>
        </h4>
   
          <div class="section-article-list__item--image">
              <a href="{% pageurl page %}">
                  {% image ancestor.sectionpage.image width-80 as tmp_photo %}
                  <img src="{{ tmp_photo.url }}" alt="{{ section.image.title }}"/>
              </a>
          </div>

          <div class="section-article-list__item-description">
              <p>{{page.subtitle}}</p>
          </div>
      </div>
      </li>
      {% else %}

      <h4 class="section-heading section-heading{{page.get_parent_section.get_effective_extra_style_hints}}">
         <a href="{% pageurl page %}">{{ parent_section.title }}</a>
      </h4>
      <li class="article-list__item">
           <div class="section-article-list__item--image">
               <a href="{% pageurl page %}">
                   {% image parent_section.sectionpage.image width-80 as tmp_photo %}
               <img src="{{ tmp_photo.url }}" alt="{{ section.image.title }}"/></a>
           </div>
           <div class="section-article-list__item-description">
               <!--a href="{% pageurl page %}" class="search-result-article-title">
                   <h3>{{ page.title }}</h3>
               </a>-->
               <p>{{ page.subtitle }}</p>
           </div>
       </li>
   
    {% endif %}
    {% endwith %}
  {% endfor %}
  </ul>
  </div>
  <div class="search-result pagination">
  <div class="pagination-step-links">
    {% if search_results.has_previous %}
        <a href="?p={{ search_results.previous_page_number }}&amp;q={{search_query}}">&larr;</a>
    {% endif %}

    <span class="current">
        Page {{ search_results.number }} of {{ search_results.paginator.num_pages }}
    </span>

    {% if search_results.has_next %}
        <a href="?p={{ search_results.next_page_number }}&amp;q={{search_query}}">&rarr;</a>
    {% endif %}
  </div>
  </div>
  {% else %}
  <h2 class="heading heading--search">{% trans "Search" %}</h2>
  <div class="section-article-list">
     <h4>{% trans "No search results for " %}{{search_query}}</h4>
    <div class="signin-form">
        <form action="{% url 'search' %}">
          <fieldset>
            <input placeholder="{% trans "I am looking for" %}" name="q" type="search">
          </fieldset>
          <input type="submit" value="{% trans "Search"%}">
        </form>
    </div>
  </div>
  {% endif %}
{% endblock %}

{% block search %}
  {% if search_results %}
      {% include "search/search_block.html" %}
  {% endif %}
{% endblock %}
